<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis on Customer Personality Dataset</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Projects</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Customer-Personality-Analysis-read.html">Customer Personality Data</a>
</li>
<li>
  <a href="Open_Police_CA.html">Open Policing Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Exploratory Data Analysis on Customer Personality Dataset</h1>

</div>


<div id="packages" class="section level2">
<h2>Packages</h2>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeSh0aW55dGV4KVxubGlicmFyeSh0aWR5dmVyc2UpXG5saWJyYXJ5KGx1YnJpZGF0ZSkgXG4jIFRoaXMgb25lIGlzIGZvciBkYXRlc1xuIyBpbnN0YWxsLnBhY2thZ2VzKFwiRGF0YUV4cGxvcmVyXCIpXG5saWJyYXJ5KERhdGFFeHBsb3JlcilcbmxpYnJhcnkobWVsdHIpXG4jIGluc3RhbGwucGFja2FnZXMoXCJwbG90bHlcIilcbmxpYnJhcnkocGxvdGx5KVxubGlicmFyeShkYXRhLnRhYmxlKVxuIyBpbnN0YWxsLnBhY2thZ2VzKFwiaW5zdGFsbHJcIikgZm9yIHVwZGF0aW5nIFJcbmxpYnJhcnkoaW5zdGFsbHIpXG5gYGAifQ== -->
<pre class="r"><code>library(tinytex)
library(tidyverse)
library(lubridate) 
# This one is for dates
# install.packages(&quot;DataExplorer&quot;)
library(DataExplorer)
library(meltr)
# install.packages(&quot;plotly&quot;)
library(plotly)
library(data.table)
# install.packages(&quot;installr&quot;) for updating R
library(installr)</code></pre>
<!-- rnb-source-end -->
</div>
<div id="the-data" class="section level2">
<h2>The Data</h2>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YSA8LSByZWFkcjo6cmVhZF9kZWxpbShcIkM6L1VzZXJzL0NocmlzL09uZURyaXZlL1IgcHJvamVjdC9DdXN0b21lciBQZXJzb25hbGl0eSBBbmFseXNpcy9tYXJrZXRpbmdfY2FtcGFpZ24uY3N2XCIpXG4jIE9wdGlvbiBmb3IgZnV0dXJlOiB1c2UgbmEuc3RyaW5ncyA9IFwiLi5cIjogaXQgcmVwbGFjZXMgYmxhbmtzIHdpdGggTkFcbiMgZmlsZUVOY29kaW5nID0gXCJVVEYtOC1CT01cIiBSIHJlYWRzIGNoYXJhY3RlcnMgYXMgY29ycmVjdGx5IGFzIHRoZXkgd291bGQgYXBwZWFyIG9uIHRoZSByYXcgZGF0YXNldFxuXG5EYXRhIDwtIERhdGEgICU+JSBzZWxlY3QoLUlELCAtWl9Db3N0Q29udGFjdCwtUmVzcG9uc2UsIC1aX1JldmVudWUsIC1Db21wbGFpbikgJT4lICAgZmlsdGVyKEluY29tZSAhPSA2NjY2NjYpICU+JSAgIG11dGF0ZShEdF9DdXN0b21lciA9IGFzLkRhdGUoRHRfQ3VzdG9tZXIsIGZvcm1hdCA9IFwiJWQtJW0tJVlcIikpIyBUaGlzIHdhcyBhZGRlZCBsYXRlclxuc3RyKERhdGEpXG5gYGAifQ== -->
<pre class="r"><code>Data &lt;- readr::read_delim(&quot;C:/Users/Chris/OneDrive/R project/Customer Personality Analysis/marketing_campaign.csv&quot;)
# Option for future: use na.strings = &quot;..&quot;: it replaces blanks with NA
# fileENcoding = &quot;UTF-8-BOM&quot; R reads characters as correctly as they would appear on the raw dataset

Data &lt;- Data  %&gt;% select(-ID, -Z_CostContact,-Response, -Z_Revenue, -Complain) %&gt;%   filter(Income != 666666) %&gt;%   mutate(Dt_Customer = as.Date(Dt_Customer, format = &quot;%d-%m-%Y&quot;))# This was added later
str(Data)</code></pre>
<!-- rnb-source-end -->
<p>The Customer Personality Analysis dataset holds information on basic customer attributes such as birth year, education, income as well as their spending habits relating to wine, fruits meat, fish. Data also includes whether customers made purchases with a discount, through the web or with the help of a catalogue</p>
<p>There are a couple of columns towards the end that I’m unclear on regarding their purpose. These are: Complain, Z_CostContact, Z_Revenue and Response. I think it is safe to remove them from the analysis. We also need to convert the date column into a date properly.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuIyBEYXRhIDwtIERhdGEgJT4lIFxuIyAgc2VsZWN0KC1aX0Nvc3RDb250YWN0LCAtIFJlc3BvbnNlLCAtWl9SZXZlbnVlLCAtQ29tcGxhaW4pICU+JSBcbiMgIG11dGF0ZShEdF9DdXN0b21lciA9IGFzLkRhdGUoRHRfQ3VzdG9tZXIsIGZvcm1hdCA9IFwiJWQtJW0tJVlcIikpIE1vdmVkIHRvIHRoZSB0b3BcblxuYGBgIn0= -->
<pre class="r"><code># Data &lt;- Data %&gt;% 
#  select(-Z_CostContact, - Response, -Z_Revenue, -Complain) %&gt;% 
#  mutate(Dt_Customer = as.Date(Dt_Customer, format = &quot;%d-%m-%Y&quot;)) Moved to the top
</code></pre>
<!-- rnb-source-end -->
<p>For the correlation matrix later we don’t need ID or customer joining date:</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YV9jb3IgPC0gRGF0YSAlPiUgc2VsZWN0X2lmKGlzLm51bWVyaWMpXG5gYGAifQ== -->
<pre class="r"><code>Data_cor &lt;- Data %&gt;% select_if(is.numeric)</code></pre>
<!-- rnb-source-end -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuc3RyKERhdGEpXG5gYGAifQ== -->
<pre class="r"><code>str(Data)</code></pre>
<!-- rnb-source-end -->
<p>This seems ok now. No real need to rename columns.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxudmlldyhEYXRhKVxuYGBgIn0= -->
<pre class="r"><code>view(Data)</code></pre>
<!-- rnb-source-end -->
<div id="exploratory-data-analysis" class="section level3">
<h3>Exploratory Data Analysis</h3>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9zdHIoRGF0YSwgdHlwZSA9IFwiZFwiKVxuIyBDYW4gY2hvb3NlIGJldHdlZW4gZCBmb3IgZGlhZ29uYWwgb3IgciBmb3IgcmFkaWFsIHBsb3RzXG5gYGAifQ== -->
<pre class="r"><code>plot_str(Data, type = &quot;d&quot;)
# Can choose between d for diagonal or r for radial plots</code></pre>
<!-- rnb-source-end -->
<p>This is a nice plot for seeing the structure of the data. If you have complicated lists of lists this works nicely to see network branches.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuaW50cm9kdWNlKERhdGEpXG5gYGAifQ== -->
<pre class="r"><code>introduce(Data)</code></pre>
<!-- rnb-source-end -->
<p>This is a quick way to see some basic information - especially the missing values that will get removed in most scenarios.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9taXNzaW5nKERhdGEpXG5gYGAifQ== -->
<pre class="r"><code>plot_missing(Data)</code></pre>
<!-- rnb-source-end -->
<p>There are some missing values in the Income column. Perhaps we will remove them for analysis relating income to other categories. Removed from the data at the start so it should show all 0’s now.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9oaXN0b2dyYW0oRGF0YVsgLCAtMV0sIG5yb3cgPSAyKSAjIC0xIGJlY2F1c2Ugd2UgZG9uJ3QgbmVlZCBJRCBoZXJlXG5gYGAifQ== -->
<pre class="r"><code>plot_histogram(Data[ , -1], nrow = 2) # -1 because we don&#39;t need ID here</code></pre>
<!-- rnb-source-end -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9kZW5zaXR5KERhdGFbICwgLTFdLCBucm93ID0gMikgIyBXZSBkb24ndCBuZWVkIElEIGhlcmUuIE5vdGUgdGhhdCB0aGlzIGlzIHVzZWxlc3MgZm9yIHRoZSBkaXNjcmV0ZSB2YXJpYWJsZXMuIExlc3MgdXNlZnVsIHRoYW4gdGhlIGhpc3RvZ3JhbXNcbmBgYCJ9 -->
<pre class="r"><code>plot_density(Data[ , -1], nrow = 2) # We don&#39;t need ID here. Note that this is useless for the discrete variables. Less useful than the histograms</code></pre>
<!-- rnb-source-end -->
<p>Filter out the discrete variables - density isn’t good for a lot of these.</p>
<div id="colourful-correlation-plot" class="section level4">
<h4>Colourful Correlation Plot</h4>
<p>A nice DIY correlation plot that I believe looks more aesthetic than most of those in packages:</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuIyBGVWxsIGNvZGVcblxuIyBsaWJyYXJ5KHBsb3RseSlcbiMgbGlicmFyeShkYXRhLnRhYmxlKVxuXG4jIEZvciB0aGUgY29ycmVsYXRpb24gcGxvdCwgd2Ugb25seSB3YW50IHRoZSBudW1lcmljIGNvbHVtbnMuIFxuIyBIZXJlIGlzIG9uZSB3YXk6XG4jbnVtcyA8LSB1bmxpc3QobGFwcGx5KERhdGFfY29yKSwgaXMubnVtZXJpYylcbiNEYXRhX2NvclsgLG51bXNdXG5cbiMgVGhpcyBvbmUgaXMgY29vbDpcbiNEYXRhX2NvclsgLG1hcF9sZ2woRGF0YV9jb3IsIGlzLm51bWVyaWMpXVxuXG4jIFNvIGlzIHRoaXM6XG4jc2VsZWN0X2lmKERhdGFfY29yLCBpcy5udW1lcmljKVxuXG4jIGFuZC4uLjpcbiNEYXRhX2NvciAlPiUgc2VsZWN0KHdoZXJlKGlzLm51bWVyaWMpKVxuXG5cbiMgRGF0YV9jb3IgaXMgdGhlIGRhdGFzZXQgKG5vdCBjb3JyZWxhdGlvbiBtYXRyaXgpIHlvdSB3YW50IHRvIHVzZVxuY29ycmRhdGEgPC0gY29yKG5hLm9taXQoc2VsZWN0X2lmKERhdGFfY29yLCBpcy5udW1lcmljKSkpXG5jb3JyZGF0YVt1cHBlci50cmkoY29ycmRhdGEsIGRpYWcgPSBUUlVFKV0gPC0gTkFcbmNvcnJkYXRhIDwtIGNvcnJkYXRhWy0xLCAtbmNvbChjb3JyZGF0YSldICMgdGFrZSBvdXQgdGhlIGZpcnN0IHJvdyAobm8gMS0xIGNvcnJlbGF0aW9ucylcblxuIyBTdG9yaW5nIHZhcmlhYmxlIG5hbWVzIGZvciBsYXRlciB1c2VcbnhfbGFiZWxzIDwtIGNvbG5hbWVzKGNvcnJkYXRhKVxueV9sYWJlbHMgPC0gcm93bmFtZXMoY29ycmRhdGEpXG5cbiMgQ2hhbmdlIHZhcmlhYmxlIG5hbWVzIHRvIG51bWVyaWMgZm9yIHRoZSBncmlkXG5jb2xuYW1lcyhjb3JyZGF0YSkgPC0gMTpuY29sKGNvcnJkYXRhKVxucm93bmFtZXMoY29ycmRhdGEpIDwtIG5yb3coY29ycmRhdGEpOjFcblxuIyBNZWx0IHRoZSBkYXRhIGludG8gIHRoZSBkZXNpcmVkIGZvcm1hdFxucGxvdGRhdGEgPC0gbWVsdChjb3JyZGF0YSlcblxuIyBBZGRpbmcgc2l6ZSB2YXJpYWJsZSBhbmQgc2NhbGluZyBpdC4gJHZhbHVlIGlzIHRoZSBjb3JyZWxhdGlvbiB2YWx1ZVxucGxvdGRhdGEkc2l6ZSA8LSAoYWJzKHBsb3RkYXRhJHZhbHVlKSlcbnNjYWxpbmcgPC0gNTAwL25jb2woY29ycmRhdGEpLzJcbnBsb3RkYXRhJHNpemUgPC0gcGxvdGRhdGEkc2l6ZSpzY2FsaW5nIFxuXG4jIFNldHRpbmcgeCBhbmQgeSByYW5nZXMgZm9yIHRoZSBjaGFydFxuIyBXZSB1c2VkIHVuaXQgdmFsdWVzIGZvciBpbml0aWFsIGdyaWQsIHNvIHNoaWZ0IGJ5IDAuNSB0byBjcmVhdGUgZ3JpZGxpbmVzXG54cmFuZ2UgPC0gYygwLjUsIGxlbmd0aCh4X2xhYmVscykgKyAwLjUpXG55cmFuZ2UgPC0gYygwLjUsIGxlbmd0aCh5X2xhYmVscykgKyAwLjUpXG5cbiMgU2V0dGluZyB0aGUgZ3JpZGxpbmVzXG54X2dyaWQgPC0gc2VxKDEuNSwgbGVuZ3RoKHhfbGFiZWxzKSAtIDAuNSwgMSlcbnlfZ3JpZCA8LSBzZXEoMS41LCBsZW5ndGgoeF9sYWJlbHMpIC0gMC41LCAxKVxuXG4jIE5vdyBzb21lIGNsZWFudXAuIE5hbWluZyB2YXJpYWJsZXMgYW5kIHJlbW92aW5nIGdyaWRsaW5lc1xuXG54QXgxIDwtIGxpc3Qoc2hvd2dyaWQgPSBGQUxTRSwgc2hvd2xpbmUgPSBGQUxTRSwgemVyb2xpbmUgPSBGQUxTRSwgdGlja3ZhbHMgPSBjb2xuYW1lcyhjb3JyZGF0YSksIHRpY2t0ZXh0ID0geF9sYWJlbHMsIHRpdGxlID0gRkFMU0UpXG5cbnhBeDIgPC0gbGlzdChzaG93Z3JpZCA9IEZBTFNFLCBzaG93bGluZSA9IEZBTFNFLCB6ZXJvbGluZSA9IEZBTFNFLCBvdmVybGF5aW5nID0gXCJ4XCIsIHNob3d0aWNrbGFiZWxzID0gRkFMU0UsIHJhbmdlID0geHJhbmdlLCB0aWNrdmFscyA9IHhfZ3JpZClcblxueUF4MSA8LSBsaXN0KGF1dG9heGlzID0gRkFMU0UsIHNob3dncmlkICA9IEZBTFNFLCBzaG93bGluZSA9IEZBTFNFLCB6ZXJvbGluZSA9IEZBTFNFLCB0aWNrdmFscyA9IHJvd25hbWVzKGNvcnJkYXRhKSwgdGlja3RleHQgPSB5X2xhYmVscywgdGl0bGUgPSBGQUxTRSlcblxueUF4MiA8LSBsaXN0KHNob3dncmlkID0gVFJVRSwgc2hvd2xpbmUgPSBGQUxTRSwgemVyb2xpbmUgPSBGQUxTRSwgb3ZlcmxheWluZyA9IFwieVwiLCBzaG93dGlja2xhYmVscyA9IEZBTFNFLCByYW5nZSA9IHlyYW5nZSwgdGlja3ZhbHMgPSB5X2dyaWQpXG5cbmZpZyA8LSBwbG90X2x5KGRhdGEgPSBwbG90ZGF0YSwgd2lkdGggPSA1MDAsIGhlaWdodCA9IDUwMClcblxuZmlnIDwtIGZpZyAlPiUgYWRkX3RyYWNlKHggPSB+VmFyMiwgeSA9IH5WYXIxLCB0eXBlID0gXCJzY2F0dGVyXCIsIG1vZGUgPSBcIm1hcmtlcnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gfnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gbGlzdChzaXplID0gfnNpemUsIG9wYWNpdHkgPSAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IEkoXCJzcXVhcmVcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gfnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaG92ZXJ0ZW1wbGF0ZSA9IFwiJXt0ZXh0Oi4yZn0gPGV4dHJhPjxcL2V4dHJhPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgeGF4aXMgPSBcIngxXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB5YXhpcyA9IFwieTFcIilcblxuZmlnIDwtIGZpZyAlPiUgYWRkX3RyYWNlKHggPSB+VmFyMiwgeSA9IH5WYXIxLCB0eXBlID0gXCJzY2F0dGVyXCIsIG1vZGUgPSBcIm1hcmtlcnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd2xlZ2VuZCA9IEZBTFNFLFxuICAgICAgICAgICAgICAgICAgICAgICAgeGF4aXMgPSBcIngyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB5YXhpcyA9IFwieTJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvdmVyaW5mbyA9IFwibm9uZVwiKVxuXG5maWcgPC0gZmlnICU+JSBsYXlvdXQoeGF4aXMgPSB4QXgxLFxuICAgICAgICAgICAgICAgICAgICAgeWF4aXMgPSB5QXgxLCBcbiAgICAgICAgICAgICAgICAgICAgIHhheGlzMiA9IHhBeDIsXG4gICAgICAgICAgICAgICAgICAgICB5YXhpczIgPSB5QXgyLFxuICAgICAgICAgICAgICAgICAgICAgcGxvdF9iZ2NvbG9yID0gXCJyZ2JhKDAsMCwwLDApXCIsXG4gICAgICAgICAgICAgICAgICAgICBwYXBlcl9iZ2NvbG9yID0gXCJyZ2JhKDAsIDAsIDAsIDAuMDMpXCIpXG5cbmZpZyA8LSBmaWcgJT4lIGNvbG9yYmFyKHRpdGxlID0gXCJcIiwgbGltaXRzID0gYygtMSwxKSwgeCA9IDEuMSwgeSA9IDAuNzUpXG5gYGAifQ== -->
<pre class="r"><code># FUll code

# library(plotly)
# library(data.table)

# For the correlation plot, we only want the numeric columns. 
# Here is one way:
#nums &lt;- unlist(lapply(Data_cor), is.numeric)
#Data_cor[ ,nums]

# This one is cool:
#Data_cor[ ,map_lgl(Data_cor, is.numeric)]

# So is this:
#select_if(Data_cor, is.numeric)

# and...:
#Data_cor %&gt;% select(where(is.numeric))


# Data_cor is the dataset (not correlation matrix) you want to use
corrdata &lt;- cor(na.omit(select_if(Data_cor, is.numeric)))
corrdata[upper.tri(corrdata, diag = TRUE)] &lt;- NA
corrdata &lt;- corrdata[-1, -ncol(corrdata)] # take out the first row (no 1-1 correlations)

# Storing variable names for later use
x_labels &lt;- colnames(corrdata)
y_labels &lt;- rownames(corrdata)

# Change variable names to numeric for the grid
colnames(corrdata) &lt;- 1:ncol(corrdata)
rownames(corrdata) &lt;- nrow(corrdata):1

# Melt the data into  the desired format
plotdata &lt;- melt(corrdata)

# Adding size variable and scaling it. $value is the correlation value
plotdata$size &lt;- (abs(plotdata$value))
scaling &lt;- 500/ncol(corrdata)/2
plotdata$size &lt;- plotdata$size*scaling 

# Setting x and y ranges for the chart
# We used unit values for initial grid, so shift by 0.5 to create gridlines
xrange &lt;- c(0.5, length(x_labels) + 0.5)
yrange &lt;- c(0.5, length(y_labels) + 0.5)

# Setting the gridlines
x_grid &lt;- seq(1.5, length(x_labels) - 0.5, 1)
y_grid &lt;- seq(1.5, length(x_labels) - 0.5, 1)

# Now some cleanup. Naming variables and removing gridlines

xAx1 &lt;- list(showgrid = FALSE, showline = FALSE, zeroline = FALSE, tickvals = colnames(corrdata), ticktext = x_labels, title = FALSE)

xAx2 &lt;- list(showgrid = FALSE, showline = FALSE, zeroline = FALSE, overlaying = &quot;x&quot;, showticklabels = FALSE, range = xrange, tickvals = x_grid)

yAx1 &lt;- list(autoaxis = FALSE, showgrid  = FALSE, showline = FALSE, zeroline = FALSE, tickvals = rownames(corrdata), ticktext = y_labels, title = FALSE)

yAx2 &lt;- list(showgrid = TRUE, showline = FALSE, zeroline = FALSE, overlaying = &quot;y&quot;, showticklabels = FALSE, range = yrange, tickvals = y_grid)

fig &lt;- plot_ly(data = plotdata, width = 500, height = 500)

fig &lt;- fig %&gt;% add_trace(x = ~Var2, y = ~Var1, type = &quot;scatter&quot;, mode = &quot;markers&quot;,
                        color = ~value,
                        marker = list(size = ~size, opacity = 1),
                        symbol = I(&quot;square&quot;),
                        text = ~value,
                        hovertemplate = &quot;%{text:.2f} &lt;extra&gt;&lt;/extra&gt;&quot;,
                        xaxis = &quot;x1&quot;,
                        yaxis = &quot;y1&quot;)

fig &lt;- fig %&gt;% add_trace(x = ~Var2, y = ~Var1, type = &quot;scatter&quot;, mode = &quot;markers&quot;,
                        opacity = 0,
                        showlegend = FALSE,
                        xaxis = &quot;x2&quot;,
                        yaxis = &quot;y2&quot;,
                        hoverinfo = &quot;none&quot;)

fig &lt;- fig %&gt;% layout(xaxis = xAx1,
                     yaxis = yAx1, 
                     xaxis2 = xAx2,
                     yaxis2 = yAx2,
                     plot_bgcolor = &quot;rgba(0,0,0,0)&quot;,
                     paper_bgcolor = &quot;rgba(0, 0, 0, 0.03)&quot;)

fig &lt;- fig %&gt;% colorbar(title = &quot;&quot;, limits = c(-1,1), x = 1.1, y = 0.75)</code></pre>
<!-- rnb-source-end -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZmlnXG5gYGAifQ== -->
<pre class="r"><code>fig</code></pre>
<!-- rnb-source-end -->
<p>Note to self: Fill in or remove the NA’s otherwise you’ll get an NA in your correlation matrix. Some interesting relationships for income are that the number of web visits and number of kids at home is negatively correlated to income. Perhaps consumers who are wealthier and can afford the extra delivery fees are ordering online. There are positive relations to the amount of wines, fruits, meat products, sweets, catalogue, and store purchases, which intuitively makes sense.</p>
</div>
</div>
<div id="bar-chart" class="section level3">
<h3>Bar Chart</h3>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9iYXIoRGF0YSkgIyBOb3RlIHRoYXQgdGhpcyBpZ25vcmVzIGNvbHVtbnMgd2l0aCA+IDUwIGNhdGVnb3JpZXMuIFN1Y2ggYXMgdGhlIGRhdGUgY29sdW1uIGFuZCBpbmNvbWUuXG5gYGAifQ== -->
<pre class="r"><code>plot_bar(Data) # Note that this ignores columns with &gt; 50 categories. Such as the date column and income.</code></pre>
<!-- rnb-source-end -->
<p>It appears the number of people using coupons is around 200 per campaign, so a little less than 10% of persons recorded. These however are quite ugly so I’ll try make something nicer using ggplot directly.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YSAlPiUgXG4gIGdyb3VwX2J5KE1hcml0YWxfU3RhdHVzKSAlPiUgXG4gIHN1bW1hcml6ZShJbmNvbWUgPSBtZWFuKEluY29tZSwgbmEucm0gPSBUUlVFKSkgJT4lIFxuICBnZ3Bsb3QoYWVzKHggPSByZW9yZGVyKE1hcml0YWxfU3RhdHVzLCBJbmNvbWUpLCB5ID0gSW5jb21lKSkgK1xuICBnZW9tX2JhcihzdGF0ID0gXCJpZGVudGl0eVwiLCBhZXMoZmlsbCA9IEluY29tZSkpICtcbiAgY29vcmRfZmxpcCgpICtcbiAgdGhlbWVfZ3JleSgpICtcbiAgc2NhbGVfZmlsbF9ncmFkaWVudChuYW1lID0gXCJJbmNvbWUgTGV2ZWxcIilcblxuIyBsb3RzIG9mIGNvbG91ciBvcHRpb25zIEkgY291bGQgZG8gaGVyZSwgYnV0IGJsdWUgbG9va3MgYWlnaHRcbiMgcmVvcmRlciBzbyBpdCBnb2VzIGZyb20gaGlnaCB0byBsb3dcbmBgYCJ9 -->
<pre class="r"><code>Data %&gt;% 
  group_by(Marital_Status) %&gt;% 
  summarize(Income = mean(Income, na.rm = TRUE)) %&gt;% 
  ggplot(aes(x = reorder(Marital_Status, Income), y = Income)) +
  geom_bar(stat = &quot;identity&quot;, aes(fill = Income)) +
  coord_flip() +
  theme_grey() +
  scale_fill_gradient(name = &quot;Income Level&quot;)

# lots of colour options I could do here, but blue looks aight
# reorder so it goes from high to low</code></pre>
<!-- rnb-source-end -->
<p>I suspect that YOLO, Alone, Absurd are answers given by providing “Other” responses from the survey. They should be removed from the plot and further analysis.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YSAlPiUgXG4gIGZpbHRlcighKE1hcml0YWxfU3RhdHVzID09IFwiQWxvbmVcIiB8IE1hcml0YWxfU3RhdHVzID09IFwiWU9MT1wiIHwgTWFyaXRhbF9TdGF0dXMgPT0gXCJBYnN1cmRcIikpICU+JSBcbiAgZ3JvdXBfYnkoTWFyaXRhbF9TdGF0dXMpICU+JSBcbiAgc3VtbWFyaXplKEluY29tZSA9IG1lYW4oSW5jb21lLCBuYS5ybSA9IFRSVUUpKSAlPiUgXG4gIGdncGxvdChhZXMoeCA9IHJlb3JkZXIoTWFyaXRhbF9TdGF0dXMsIEluY29tZSksIHkgPSBJbmNvbWUpKSArXG4gIGdlb21fYmFyKHN0YXQgPSBcImlkZW50aXR5XCIsIGFlcyhmaWxsID0gSW5jb21lKSkgK1xuICBjb29yZF9mbGlwKCkgK1xuICB0aGVtZV9ncmV5KCkgK1xuICBzY2FsZV9maWxsX2dyYWRpZW50KG5hbWUgPSBcIkluY29tZSBMZXZlbFwiKSArXG4gIGxhYnModGl0bGUgPSBcIkF2ZXJhZ2UgSW5jb21lIGZvciBDdXN0b21lcnMgYmFzZWQgb24gTWFyaXRhbCBTdGF0dXNcIiwgeCA9IFwiTWFyaXRhbCBTdGF0dXNcIiwgeSA9IFwiSW5jb21lXCIpXG5gYGAifQ== -->
<pre class="r"><code>Data %&gt;% 
  filter(!(Marital_Status == &quot;Alone&quot; | Marital_Status == &quot;YOLO&quot; | Marital_Status == &quot;Absurd&quot;)) %&gt;% 
  group_by(Marital_Status) %&gt;% 
  summarize(Income = mean(Income, na.rm = TRUE)) %&gt;% 
  ggplot(aes(x = reorder(Marital_Status, Income), y = Income)) +
  geom_bar(stat = &quot;identity&quot;, aes(fill = Income)) +
  coord_flip() +
  theme_grey() +
  scale_fill_gradient(name = &quot;Income Level&quot;) +
  labs(title = &quot;Average Income for Customers based on Marital Status&quot;, x = &quot;Marital Status&quot;, y = &quot;Income&quot;)</code></pre>
<!-- rnb-source-end -->
</div>
<div id="violin-plot" class="section level3">
<h3>Violin Plot</h3>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9zY2F0dGVycGxvdChEYXRhX2NvciwgYnkgPSBcIkluY29tZVwiKVxuYGBgIn0= -->
<pre class="r"><code>plot_scatterplot(Data_cor, by = &quot;Income&quot;)</code></pre>
<!-- rnb-source-end -->
<p>There is one data point that is unusally high for income. Let’s investigate it:</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YSAlPiUgc2xpY2VfbWF4KEluY29tZSwgbiA9IDEwKVxuXG5EYXRhIDwtIERhdGEgJT4lIFxuICBmaWx0ZXIoSW5jb21lICE9IDY2NjY2NilcbmBgYCJ9 -->
<pre class="r"><code>Data %&gt;% slice_max(Income, n = 10)

Data &lt;- Data %&gt;% 
  filter(Income != 666666)</code></pre>
<!-- rnb-source-end -->
<p>The largest number is 666,666! Seeing it is such a big outlier and how it’s entered removing it from further analysis.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuRGF0YSA8LSBEYXRhICU+JSBcbiAgZmlsdGVyKEluY29tZSAhPSA2NjY2NjYpXG5gYGAifQ== -->
<pre class="r"><code>Data &lt;- Data %&gt;% 
  filter(Income != 666666)</code></pre>
<!-- rnb-source-end -->
<p>Let’s have a look at the scatterplots now:</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9zY2F0dGVycGxvdChEYXRhLCBieSA9IFwiSW5jb21lXCIpXG5gYGAifQ== -->
<pre class="r"><code>plot_scatterplot(Data, by = &quot;Income&quot;)</code></pre>
<!-- rnb-source-end -->
<p>There seem to be a couple of outliers who earn very high income, but do not purchase much of anything. Otherwise there seems to be a (expected) linear increase between number of store purchases and income.</p>
<p>Honestly these scatterplots are a bit ugly so let’s make something nicer: a violin plot.</p>
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuIyBpbnN0YWxsLnBhY2thZ2VzKFwiZ2diZWVzd2FybVwiKVxubGlicmFyeShnZ2JlZXN3YXJtKVxubGlicmFyeShnZ3B1YnIpXG5EYXRhICU+JSBcbiAgZmlsdGVyKCEoTWFyaXRhbF9TdGF0dXMgPT0gXCJBbG9uZVwiIHwgTWFyaXRhbF9TdGF0dXMgPT0gXCJZT0xPXCIgfCBNYXJpdGFsX1N0YXR1cyA9PSBcIkFic3VyZFwiKSkgJT4lIFxuICBnZ3Bsb3QoYWVzKHggPSBNYXJpdGFsX1N0YXR1cywgeSA9IEluY29tZSwgZmlsbCA9IE1hcml0YWxfU3RhdHVzKSkgK1xuICBzY2FsZV9maWxsX3ZpcmlkaXNfZChvcHRpb24gPSBcIkRcIikgK1xuICBnZW9tX3Zpb2xpbihhbHBoYSA9IDAuNSwgcG9zaXRpb24gPSBwb3NpdGlvbl9kb2RnZSh3aWR0aCA9IDAuNzUpLCBzaXplID0gMSwgY29sb3VyID0gTkEpICtcbiAgZ2VvbV9ib3hwbG90KG5vdGNoID0gVFJVRSwgb3V0bGllci5zaXplID0gLTEsIGNvbG91ciA9IFwiYmxhY2tcIiwgbHdkID0gMSwgYWxwaGEgPSAwLjcsIHNob3cubGVnZW5kID0gRikgKyBcbiAgZ2VvbV9wb2ludChzaGFwZSA9IDIxLCBzaXplID0gMSwgcG9zaXRpb24gPSBwb3NpdGlvbl9qaXR0ZXJkb2RnZSgpLCBjb2xvdXI9XCJibGFja1wiLGFscGhhPTEpICtcbiAgdGhlbWVfcHVicigpICsgIyBtb3ZlcyBsZWdlbmQgdG8gdG9wIGFuZCByZW1vdmVzIHNvbWUgYXhpcyBsaW5lcy4gVGhpcyBoYXMgdG8gYmUgdXNlZCBlYXJseVxuICBnZ2JlZXN3YXJtOjpnZW9tX3F1YXNpcmFuZG9tKHNoYXBlID0gMjEsIHNpemUgPSAxLCBkb2RnZS53aWR0aCA9IDAuNzUsIGNvbG91ciA9IFwiYmxhY2tcIiwgYWxwaGEgPSAwLjUsIHNob3cubGVnZW5kID0gRikgK1xuICB0aGVtZV9taW5pbWFsKCkgK1xuICB5bGFiKGMoXCJJbmNvbWUgb2YgQ3VzdG9tZXJcIikpICtcbiAgeGxhYihjKFwiTWFyaXRhbCBTdGF0dXMgb2YgQ3VzdG9tZXJcIikpICsgXG5cbiAgdGhlbWUocGFuZWwuYm9yZGVyID0gZWxlbWVudF9yZWN0KGNvbG91ciA9IFwiZ3JheVwiLCBmaWxsID0gTkEsIHNpemUgPSAyKSxcbiAgICAgICAgYXhpcy5saW5lID0gZWxlbWVudF9saW5lKGNvbG91ciA9IFwiYmxhY2tcIiwgc2l6ZSA9IDEpLFxuICAgICAgICBheGlzLnRpY2tzID0gZWxlbWVudF9saW5lKGNvbG91ciA9IFwiYmxhY2tcIiksXG4gICAgICAgIGF4aXMudGV4dCA9IGVsZW1lbnRfdGV4dChjb2xvdXIgPSBcImJsYWNrXCIpLFxuICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCB2anVzdCA9IDAuNSwgaGp1c3QgPSAxKVxuICAgICAgICApICtcbiAgZm9udChcInh5bGFiXCIsIHNpemUgPSAxNSkgK1xuICBmb250KFwieHlcIiwgc2l6ZSA9IDE1KSArXG4gIGZvbnQoXCJ4eS50ZXh0XCIsIHNpemUgPSAgMTUpICtcbiAgZm9udChcImxlZ2VuZC50ZXh0XCIsIHNpemUgPSAxNSkgK1xuICBycmVtb3ZlKFwibGVnZW5kLnRpdGxlXCIpICsjIHJlbW92ZXMgTWFyaXRhbF9zdGF0dXMgb24gbGVnZW5kXG4gIGd1aWRlcyhmaWxsID0gZ3VpZGVfbGVnZW5kKG92ZXJyaWRlLmFlcyA9IGxpc3QoYWxwaGEgPSAxLCBjb2xvdXIgPSBcImJsYWNrXCIpKSkgICMgQ2hvb3NlIGFueSBjb2xvdXIgeW91IHdhbnRcbiBcbmBgYCJ9 -->
<pre class="r"><code># install.packages(&quot;ggbeeswarm&quot;)
library(ggbeeswarm)
library(ggpubr)
Data %&gt;% 
  filter(!(Marital_Status == &quot;Alone&quot; | Marital_Status == &quot;YOLO&quot; | Marital_Status == &quot;Absurd&quot;)) %&gt;% 
  ggplot(aes(x = Marital_Status, y = Income, fill = Marital_Status)) +
  scale_fill_viridis_d(option = &quot;D&quot;) +
  geom_violin(alpha = 0.5, position = position_dodge(width = 0.75), size = 1, colour = NA) +
  geom_boxplot(notch = TRUE, outlier.size = -1, colour = &quot;black&quot;, lwd = 1, alpha = 0.7, show.legend = F) + 
  geom_point(shape = 21, size = 1, position = position_jitterdodge(), colour=&quot;black&quot;,alpha=1) +
  theme_pubr() + # moves legend to top and removes some axis lines. This has to be used early
  ggbeeswarm::geom_quasirandom(shape = 21, size = 1, dodge.width = 0.75, colour = &quot;black&quot;, alpha = 0.5, show.legend = F) +
  theme_minimal() +
  ylab(c(&quot;Income of Customer&quot;)) +
  xlab(c(&quot;Marital Status of Customer&quot;)) + 

  theme(panel.border = element_rect(colour = &quot;gray&quot;, fill = NA, size = 2),
        axis.line = element_line(colour = &quot;black&quot;, size = 1),
        axis.ticks = element_line(colour = &quot;black&quot;),
        axis.text = element_text(colour = &quot;black&quot;),
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)
        ) +
  font(&quot;xylab&quot;, size = 15) +
  font(&quot;xy&quot;, size = 15) +
  font(&quot;xy.text&quot;, size =  15) +
  font(&quot;legend.text&quot;, size = 15) +
  rremove(&quot;legend.title&quot;) +# removes Marital_status on legend
  guides(fill = guide_legend(override.aes = list(alpha = 1, colour = &quot;black&quot;)))  # Choose any colour you want
 </code></pre>
<!-- rnb-source-end -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGxvdF9oaXN0b2dyYW0oRGF0YV9jb3IsbnJvdyA9IDIsIG5jb2wgPSAyKVxuIyBIYXZlIHNvbWUgc29ydCBvZiBtYXRyaXggZm9yIHRoZXNlIGJlY2F1c2Ugb3RoZXJ3aXNlIGl0IGlzIHRvbyBtZXNzeVxuYGBgIn0= -->
<pre class="r"><code>plot_histogram(Data_cor,nrow = 2, ncol = 2)
# Have some sort of matrix for these because otherwise it is too messy</code></pre>
<!-- rnb-source-end -->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
